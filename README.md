# elephant-edge
---
This project is submitted to the elephant edge contest by hackster.io.
---
The aim of the project is to train a model on edge impulse for elephant activity classification based on accelerometer data. Then use the [.tflite](https://github.com/tirsaiwalamubin/elephant-edge/blob/master/ei-elephant-edge-10hz-nn-classifier-tensorflow-lite-float32-model.lite)  file to do real time predictions for incoming data. In the end, show the straming data, predictions and gps location data on a dashboard.  
  
For simulating the real time data (*part of the project*), data is generated by random sampling from a gaussian normal distribution with mean and standard deviation values from [paper](https://www.researchgate.net/publication/305337898_Using_simple_algorithms_accelerometers_identify_activity_budgets_and_body_orientation_in_African_elephants_Loxodonta_africana) and the model was trained using this.  

## Activity classification:  
---  
For activity part, the data that we have is dynamic acceleration values for x, y and z axes and has four classes **Bathing**, **Swaying**, **Walking** and **Feeding**. For classification first load in the [.tflite](https://github.com/tirsaiwalamubin/elephant-edge/blob/master/ei-elephant-edge-10hz-nn-classifier-tensorflow-lite-float32-model.lite) file in the interpretor and allocate tensors to it.  
Then, we just pass the data to be classified to the `.set_tensor()` method of the interpreter at a particular index where the interpreter is expecting the data to come at and invoke the interpreter to get back outputs from the interpreter at a set index.  
This output is an array of probabilities of each class and hence, we perform `argmax()` to get the output class. This is all done in [app.py](https://github.com/tirsaiwalamubin/elephant-edge/blob/master/app.py).  
```
interpreter.set_tensor(input_details[0]['index'], np.expand_dims(np.asarray(data).astype(np.float32), 0))
interpreter.invoke()
output = interpreter.get_tensor(output_details[0]['index'])
classes = ['bathing', 'feeding', 'swaying', 'walking']
prediction = classes[np.argmax(output)]
```  
## GPS co-ordinates:
---  
For GPS co-ordinates, we have a dataset of latitudes and longitudes obtained from [movebank.org](https://www.movebank.org/cms/movebank-main) for 10 different elephants collected by placing a collar with gps sensor on it.  
We converted the co-ordinates of each elephant to a .geojson file as this is a standard format in which geospatial data is kept. This can be found in the repo [here](https://github.com/tirsaiwalamubin/elephant-edge/tree/master/geojson_files).  
  
## Dashboard:  
---  
We will have two different types of plot. One is a line chart for plotting acceleration values and another will be a heatmap showing the intensity of elephant movement.  
The dashboard will be of dynamic type which simulates real world scenario in which continuous data is streaming from the sensor and real time prediction is also going on.  
For plotting, we have used [chart.js](https://www.chartjs.org/) and [leaflet.js](https://leafletjs.com/) libraries of javascript. The code for rendering the webpage and design is in [templates/index.html](https://github.com/tirsaiwalamubin/elephant-edge/tree/master/templates).  

## App hosting:
---
We have used flask to host our app. The workflow of the app is like:  
1. Get request from the webpage asking for accelerometer data and prediction.
2. Plotting the chart and providing output.
3. Rendering the map with default being heatmap for all elephants.
4. Whenever an elephant from the dropdown box is selected, get request is sent and the map is rendered again.

![](https://github.com/tirsaiwalamubin/elephant-edge/blob/master/elephant-edge.gif)
